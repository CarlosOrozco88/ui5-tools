module.exports=function(e){var t={};function r(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,o){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(o,i,function(t){return e[t]}.bind(null,i));return o},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}([function(e,t){e.exports=require("vscode")},function(e,t,r){const{workspace:o}=r(0),i=r(2),n=r(3);function a(e=""){return e&&(e="."+e),o.getConfiguration("ui5-tools"+e)}function s(e,t=""){return e?a(t).get(e):a(t)}function u(e){return s(e)}function c(e){return s(e,"server")}function l(e){return s(e,"builder")}function p(){let e=o.rootPath;if(e){let t=e.split("/");t.pop(),e=t.join("/")}return e}e.exports={getConfigurationGeneral:u,getConfigurationServer:c,getConfigurationBuilder:l,getRoot:p,loadConfig:function(e=!1){let t=u("srcFolder"),r=u("distFolder"),a=u("ui5Version"),s=c("name"),d=c("port"),f=c("openBrowser"),g=c("watch"),y=c("watchExtensions"),h=c("gatewayProxy"),w=c("gatewayUri"),v=c("resourcesProxy"),x=c("localDependencies"),S=c("serveFolder"),b=c("protocol"),m=l("debugSources"),C=l("uglifySources"),j=!e&&f,P=p(),k=[],U=[],O={},N=[],F=[],E={},$=[],I="Source Folder"===S?t:r;if(!o.workspaceFolders)throw new Error("Create at least one project in your workspace");{let e,t;o.workspaceFolders.forEach(r=>{e=""+r.uri.path.split(i.sep).pop(),n.existsSync(i.join(P,e,I))&&($.push(r),N.push(e),k.push(i.join(e,I,`*.{${y}}`)),k.push(i.join(e,I,"**",`*.{${y}}`)),t="/"+e,O[t]=i.join(e,I),F.push(i.join(P,e,I)),E[t]=i.join(P,e,I),U.push({route:e,dir:i.join(r.uri.path,I)}))})}return{srcFolder:t,distFolder:r,ui5Version:a,serverName:s,port:d,openBrowser:f,watch:g,watchExtensions:y,gatewayProxy:h,gatewayUri:w,resourcesProxy:v,localDependencies:x,serveFolder:S,index:"index.html",protocol:b,debugSources:m,uglifySources:C,baseDir:P,foldersRoot:F,foldersRootMap:E,folders:N,foldersWithName:$,files:k,serveStatic:U,routes:O,open:j,portLiveReload:35729}},get404:function(){let e="<html><head><title>UI5 Server</title></head><body>";return e+="<p>ERROR 404</p>",e+="</body></html>","<html><head><title>UI5 Server</title></head><body><p>ERROR 404</p></body></html>"}}},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("fs")},function(e,t,r){const{window:o,StatusBarAlignment:i}=r(0),n=r(1);let a,s=[],u="";function c(){u="startText";let{serverName:e}=n.loadConfig();a.text="$(debug-start) Start "+e}e.exports={init:function({subscriptions:e}){a=o.createStatusBarItem(i.Left,100),a.command="ui5-tools.server.toggle",e.push(a),c(),a.show()},startText:c,stopText:function(){u="stopText";let e=function(){let e=" ";s.length&&(e=" $(alert)");return e}(),{serverName:t,port:r}=n.loadConfig();a.text=`$(broadcast)${e} ${t} live at port ${r}`},startingText:function(){u="startingText";let{serverName:e}=n.loadConfig();a.text=`$(loading) Starting ${e}...`},stoppingText:function(){u="stoppingText",s=[];let{serverName:e}=n.loadConfig();a.text=`$(loading) Stopping ${e}...`},pushError:function(e){e&&(s.push(e),this&&this[u]&&this[u]())}}},function(e,t,r){const{commands:o}=r(0),{registerCommand:i}=o,n=r(6),a=r(14),s=r(15),u=r(4),c=r(1);function l(e){const{subscriptions:t}=e;u.init(e),c.getConfigurationServer("startOnLaunch")&&n.start(),t.push(i("ui5-tools.server.start",()=>n.start())),t.push(i("ui5-tools.server.stop",()=>n.stop())),t.push(i("ui5-tools.server.restart",()=>n.restart())),t.push(i("ui5-tools.server.toggle",()=>n.toggle())),t.push(i("ui5-tools.builder.build",()=>s.build())),t.push(i("ui5-tools.configurator.odataProvider",()=>a.odataProvider())),t.push(i("ui5-tools.configurator.ui5Provider",()=>a.ui5Provider()))}t.activate=l,e.exports={activate:l,deactivate:function(){}}},function(e,t,r){(function(t){const o=r(7),{workspace:i,window:n}=r(0),a=r(8),s=r(9),u=r(10),{createProxyMiddleware:c}=r(11),l=r(12),p=r(2),d=r(3),f=r(13),g=r(4),y=r(1);let h,w,v;async function x(e=!1){try{g.startingText();let r=y.loadConfig(e),{foldersRootMap:i,folders:u,port:f,watch:x,baseDir:b,open:m,index:C,protocol:j}=r;h=o(),h.use("/index.html",o.static(p.join(b,"index.html"))),x&&function(e,{foldersRoot:t,portLiveReload:r}){v=a.createServer({extraExts:"xml,json,properties",watchDirs:t,app:e,port:r}),v.watch(t),e.use(s({ignore:[],port:r}))}(h,r),Object.entries(i).forEach(([e,t])=>{h.use(e,o.static(t))}),await async function(e,t=[]){let r,o;switch(y.getConfigurationServer("gatewayProxy")){case"Gateway":o=y.getConfigurationServer("gatewayUri"),r=c({pathRewrite:{},target:o,secure:0==o.indexOf("https"),changeOrigin:!0,logLevel:"debug"}),e.use("/sap",r)}return}(h,u),await async function(e,t=[]){let r,o,i,a,s=y.getConfigurationServer("resourcesProxy");switch(s){case"Gateway":r=y.getConfigurationServer("gatewayUri"),i="/sap/bc/ui5_ui5/sap",o={"^/":i+"/"},a=c({pathRewrite:o,target:r,secure:0==r.indexOf("https"),changeOrigin:!0,logLevel:"debug"}),e.use("/**/resources/**",a);break;case"CDN SAPUI5":case"CDN OpenUI5":let u=s.indexOf("SAPUI5")>=0?"sapui5":"openui5",p=y.getConfigurationGeneral("ui5Version");r=`https://${u}.hana.ondemand.com/${p}/`,i="/",o={},t.forEach(e=>{o[`^/${e}/`]=i}),a=c({pathRewrite:o,target:r,secure:0==r.indexOf("https"),changeOrigin:!0,logLevel:"debug"}),e.use("/**/resources/**",a),l.get(r+"resources/sap-ui-core.js",({statusCode:e})=>{if(200!==e){let e=`Error: Unable to get sap-ui-core.js, framework ${u} does not have ${p} available at CDN.`;g.pushError(e),n.showErrorMessage(e)}}).on("error",e=>{let t=`Error: Unable to get sap-ui-core.js, framework ${u} does not have ${p} available at CDN.`;g.pushError(t),n.showErrorMessage(t)})}return}(h,u),await async function(e){return void e.use((function(e,t){t.status(404).send(y.get404())}))}(h),w="https"==j?l.createServer({key:d.readFileSync(p.join(t,"cert","server.key")),cert:d.readFileSync(p.join(t,"cert","server.cert"))},h).listen(f,()=>{S(m,e,u,C,f,j)}):h.listen(f,()=>{S(m,e,u,C,f,j)})}catch(e){throw new Error(e)}}function S(e,t,r,o,i,n){if(g.stopText(),e&&!t){let e="";1==r.length&&(e=r[0]);let t=f(`${n}://localhost:${i}`,e,o);u(t)}}function b(){return g.stoppingText(),new Promise(e=>{w.close(()=>{h=void 0,w=void 0,g.startText(),e()})})}e.exports={start:x,stop:b,restart:async function(){await b(),await x(!0)},toggle:async function(){w&&w.listening?await b():await x()},get:function(){return w}}}).call(this,"/")},function(e,t){e.exports=require("express")},function(e,t){e.exports=require("livereload")},function(e,t){e.exports=require("connect-livereload")},function(e,t){e.exports=require("opn")},function(e,t){e.exports=require("http-proxy-middleware")},function(e,t){e.exports=require("https")},function(e,t){e.exports=require("url-join")},function(e,t,r){const{window:o,ConfigurationTarget:i}=r(0),n=r(1);e.exports={odataProvider:async function(){let e=n.getConfigurationServer("gatewayProxy"),t=await o.showQuickPick([{description:"Gateway url",label:"Gateway",picked:"Gateway"==e},{description:"Without odata provider",label:"None",picked:"None"==e}],{placeHolder:"Select odata provider (proxy all /sap)",canPickMany:!1});if(await n.getConfigurationServer().update("gatewayProxy",t.label,i.Workspace),"Gateway"==t.label){let e=await o.showInputBox({placeHolder:"Enter gateway url",value:n.getConfigurationServer("gatewayUri")});await n.getConfigurationServer().update("gatewayUri",e,i.Workspace)}},ui5Provider:async function(){let e=n.getConfigurationServer("resourcesProxy"),t=await o.showQuickPick([{description:"Use resources from gateway",label:"Gateway",picked:"Gateway"==e},{description:"Use SAPUI5 CDN",label:"CDN SAPUI5",picked:"CDN SAPUI5"==e},{description:"Use OpenUI5 CDN",label:"CDN OpenUI5",picked:"CDN OpenUI5"==e},{description:"Without resources proxy",label:"None",picked:"None"==e}],{placeHolder:"Select odata provider (proxy all /sap)",canPickMany:!1});if(await n.getConfigurationServer().update("resourcesProxy",t.label,i.Workspace),"Gateway"==t.label){let e=await o.showInputBox({placeHolder:"Enter gateway url",value:n.getConfigurationServer("gatewayUri")});await n.getConfigurationServer().update("gatewayUri",e,i.Workspace)}let r=t.label.indexOf("SAPUI5")>=0?"SAPUI5":"OpenUI5",a=await o.showInputBox({placeHolder:`Enter ${r} version`,value:n.getConfigurationGeneral("ui5Version")});await n.getConfigurationGeneral().update("ui5Version",a,i.Workspace)}}},function(e,t,r){const{workspace:o,window:i,ConfigurationTarget:n}=r(0),a=r(2),s=r(3),u=r(1),c=r(16),l=r(17),p=r(18);e.exports={build:async function(e){if(e||(e=await async function(){let e=void 0;try{let{foldersWithName:t}=u.loadConfig(),r=[];if(t.forEach(e=>{r.push({description:e.uri.path!=e.name?a.sep+e.uri.path.split(a.sep).pop():"",label:e.name})}),r.length>1){let o=await i.showQuickPick(r,{placeHolder:"Select UI5 project to build",canPickMany:!1});e=t.filter(e=>e.name==o.label)[0].uri.path}else 1==r.length&&(e=r[0].uri.path)}catch(t){e=void 0}return e}()),e){let{srcFolder:t,distFolder:r,ui5Version:o,debugSources:i,uglifySources:n}=u.loadConfig();if(!t||!r||t==r)throw"Invalid srcFolder or distFolder";let d=o.split(".");for(;d.length>2;)d.pop();let f=d.join(".");c.sync(a.join(e,r)),function e(t,r,o=!0,i=!0){var n=s.existsSync(t),u=n&&s.statSync(t);if(n&&u.isDirectory())s.mkdirSync(r),s.readdirSync(t).forEach((function(n){e(a.join(t,n),a.join(r,n),o,i)}));else switch(a.extname(t)){case".js":let e=!0;if(i){let o=s.readFileSync(t,"utf8"),i=p.minify(o);i.error||(e=!1,s.writeFileSync(r,i.code))}e&&s.copyFileSync(t,r),o&&s.copyFileSync(t,r.replace(".js","-dbg.js"));break;case".json":let n=s.readFileSync(t,"utf8"),a=JSON.stringify(JSON.parse(n));s.writeFileSync(r,a);break;default:s.copyFileSync(t,r)}}(a.join(e,t),a.join(e,r),i,n);let g=JSON.parse(s.readFileSync(a.join(e,t,"manifest.json"),"utf-8")),y=g["sap.app"].id,h="library"==g["sap.app"].type,w=y.split(".").join("/"),v=a.join(e,t),x=a.join(e,r);l({resources:{cwd:v,prefix:w},dest:x,compatVersion:f,compress:!0,verbose:!1,components:!h&&w,libraries:!!h&&w})}}}},function(e,t){e.exports=require("rimraf")},function(e,t){e.exports=require("ui5-preload")},function(e,t){e.exports=require("uglify-js")}]);
//# sourceMappingURL=extension.js.map